{"id":4167,"date":"2019-05-12T06:29:28","date_gmt":"2019-05-12T13:29:28","guid":{"rendered":"http:\/\/www.postgresqltutorial.com\/?page_id=4167"},"modified":"2020-07-09T21:57:36","modified_gmt":"2020-07-10T04:57:36","slug":"postgresql-rank-function","status":"publish","type":"page","link":"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/postgresql-rank-function\/","title":{"rendered":"PostgreSQL RANK Function"},"content":{"rendered":"\n<p><strong>Summary<\/strong>: in this tutorial, you will learn how to use PostgreSQL <code>RANK()<\/code> function to assign a rank for every row of a result set.<\/p>\n\n\n\n<h2>Introduction to PostgreSQL <code>RANK()<\/code> function<\/h2>\n\n\n\n<p>The <code>RANK()<\/code> function assigns a rank to every row within a partition of a result set.<\/p>\n\n\n\n<p>For each partition, the rank of the first row is 1. The <code>RANK()<\/code> function adds the number of tied rows to the tied rank to calculate the rank of the next row, so the ranks may not be sequential. In addition, rows with the same values will get the same rank.<\/p>\n\n\n\n<p>The following illustrates the syntax of the <code>RANK()<\/code> function:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-1\" data-shcb-language-name=\"CSS\" data-shcb-language-slug=\"css\"><div><code class=\"hljs language-css\"><span class=\"hljs-selector-tag\">RANK<\/span>() <span class=\"hljs-selector-tag\">OVER<\/span> (\n    <span class=\"hljs-selector-attr\">[PARTITION BY partition_expression, ... ]<\/span>\n    <span class=\"hljs-selector-tag\">ORDER<\/span> <span class=\"hljs-selector-tag\">BY<\/span> <span class=\"hljs-selector-tag\">sort_expression<\/span> <span class=\"hljs-selector-attr\">[ASC | DESC]<\/span>, ...\n)<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-1\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">CSS<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">css<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>In this syntax:<\/p>\n\n\n\n<ul><li>First, the <code>PARTITION BY<\/code> clause distributes rows of the result set into partitions to which the <code>RANK()<\/code> function is applied.<\/li><li>Then, the <code>ORDER BY<\/code> clause specifies the order of rows in each a partition to which the function is applied.<\/li><\/ul>\n\n\n\n<p>The <code>RANK()<\/code> function can be useful for creating top-N and bottom-N reports.<\/p>\n\n\n\n<h2>PostgreSQL <code>RANK()<\/code> function demo<\/h2>\n\n\n\n<p>First, <a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-create-table\/\">create a new table<\/a> named <code>ranks<\/code> that contains one column:<\/p>\n\n\n<pre class=\"wp-block-code\"><div><code class=\"hljs\">CREATE TABLE ranks (\n\tc VARCHAR(10)\n);<\/code><\/div><\/pre>\n\n\n<p>Second, <a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-insert\/\">insert some rows<\/a> into the <code>ranks<\/code>&nbsp;table:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-2\" data-shcb-language-name=\"JavaScript\" data-shcb-language-slug=\"javascript\"><div><code class=\"hljs language-javascript\">INSERT INTO ranks(c)\nVALUES(<span class=\"hljs-string\">'A'<\/span>),(<span class=\"hljs-string\">'A'<\/span>),(<span class=\"hljs-string\">'B'<\/span>),(<span class=\"hljs-string\">'B'<\/span>),(<span class=\"hljs-string\">'B'<\/span>),(<span class=\"hljs-string\">'C'<\/span>),(<span class=\"hljs-string\">'E'<\/span>);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-2\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">JavaScript<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">javascript<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>Third, query data from the <code>ranks<\/code>&nbsp;table:<\/p>\n\n\n<pre class=\"wp-block-code\"><div><code class=\"hljs\">SELECT \n\tc\nFROM\n\tranks;<\/code><\/div><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"183\" height=\"212\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2019\/05\/PostgreSQL-RANK-function-sample-table.png\" alt=\"PostgreSQL RANK function - sample table\" class=\"wp-image-4168\"\/><\/figure>\n\n\n\n<p>Fourth, use the <code>RANK()<\/code> function to assign ranks to the rows in the result set of <code>ranks<\/code> table:<\/p>\n\n\n<pre class=\"wp-block-code\"><div><code class=\"hljs\">SELECT\n\tc,\n\tRANK () OVER ( \n\t\tORDER BY c \n\t) rank_number \nFROM\n\tranks;<\/code><\/div><\/pre>\n\n\n<p>The following picture shows the output:<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"288\" height=\"208\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2019\/05\/PostgreSQL-RANK-function-example.png\" alt=\"\" class=\"wp-image-4169\"\/><\/figure>\n\n\n\n<p>As you can see clearly from the output:<\/p>\n\n\n\n<ul><li>The first and second rows receive the same rank because they have the same value <code>A<\/code>.<\/li><li>The third, fourth, and fifth rows receive the rank 3 because the <code>RANK()<\/code> function skips the rank 2 and all of them have the same values <code>B<\/code>.<\/li><\/ul>\n\n\n\n<h2>PostgreSQL <code>RANK()<\/code> function examples<\/h2>\n\n\n\n<p>We&#8217;ll use the <code>products<\/code> table to demonstrate the <code>RANK()<\/code> function:<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"540\" height=\"173\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2016\/06\/products_product_groups_tables.png\" alt=\"\" class=\"wp-image-2268\" srcset=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2016\/06\/products_product_groups_tables.png 540w, https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2016\/06\/products_product_groups_tables-300x96.png 300w\" sizes=\"(max-width: 540px) 100vw, 540px\" \/><\/figure>\n\n\n\n<p>This picture shows the data of the <code>products<\/code> table:<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"480\" height=\"313\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2019\/05\/products-table-sample-data.png\" alt=\"\" class=\"wp-image-4170\"\/><\/figure>\n\n\n\n<h3>1) Using PostgreSQL <code>RANK()<\/code> function for the whole result set<\/h3>\n\n\n\n<p>This example uses the <code>RANK()<\/code> function to assign a rank to each product by its price:<\/p>\n\n\n<pre class=\"wp-block-code\"><div><code class=\"hljs\">SELECT\n\tproduct_id,\n\tproduct_name,\n\tprice,\n\tRANK () OVER ( \n\t\tORDER BY price DESC\n\t) price_rank \nFROM\n\tproducts;<\/code><\/div><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"486\" height=\"312\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2019\/05\/PostgreSQL-RANK-function-over-the-result-set.png\" alt=\"PostgreSQL RANK function over the result set\" class=\"wp-image-4171\"\/><\/figure>\n\n\n\n<p>In this example, we omitted the <code>PARTITION BY<\/code> clause, therefore, the <code>RANK()<\/code> function treated the whole result set as a single partition.<\/p>\n\n\n\n<p>The <code>RANK()<\/code> function calculated a rank for each row within the whole result set sorted by prices from high to low.<\/p>\n\n\n\n<h3>2) Using PostgreSQL <code>RANK()<\/code> function with <code>PARTITION BY<\/code> clause example<\/h3>\n\n\n\n<p>The following example uses the <code>RANK()<\/code> function to assign a rank to every product in each product group:<\/p>\n\n\n<pre class=\"wp-block-code\"><div><code class=\"hljs\">SELECT\n\tproduct_id,\n\tproduct_name,\n\tgroup_name,\n\tprice,\n\tRANK () OVER ( \n\t\tPARTITION BY p.group_id\n\t\tORDER BY price DESC\n\t) price_rank \nFROM\n\tproducts p\n\tINNER JOIN product_groups g \n\t\tON g.group_id = p.group_id;<\/code><\/div><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"659\" height=\"310\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2019\/05\/PostgreSQL-RANK-function-over-partition.png\" alt=\"PostgreSQL RANK function over partition\" class=\"wp-image-4172\"\/><\/figure>\n\n\n\n<p>In this example:<\/p>\n\n\n\n<ul><li>First, the <code>PARTITION BY<\/code> clause distributes products into partitions grouped by product group id (<code>group_id<\/code>).<\/li><li>Second, the <code>ORDER BY<\/code> clause sort products in each partition by their prices from high to low.<\/li><\/ul>\n\n\n\n<p>The <code>RANK()<\/code> function was applied to every product in each product group and it is reinitialized when the product group changed.<\/p>\n\n\n\n<p>In this tutorial, you have learned how to use the PostgreSQL <code>RANK()<\/code> function to calculate a rank for every row in a partition of a result set.<\/p>\n<div class=\"helpful-block-content\" data-title=\"\">\n\t<header>\n\t\t<div class=\"wth-question\">Was this tutorial helpful ?<\/div>\n\t\t<div class=\"wth-thumbs\">\n\t\t\t<button\n\t\t\t\tdata-post=\"4167\"\n\t\t\t\tdata-post-url=\"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/postgresql-rank-function\/\"\n\t\t\t\tdata-post-title=\"PostgreSQL RANK Function\"\n\t\t\t\tdata-response=\"1\"\n\t\t\t\tclass=\"wth-btn-rounded wth-yes-btn\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http:\/\/www.w3.org\/2000\/svg\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\tclass=\"feather feather-thumbs-up block w-full h-full\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3\"\n\t\t\t\t\t><\/path>\n\t\t\t\t<\/svg>\n\t\t\t\t<span class=\"sr-only\"> Yes <\/span>\n\t\t\t<\/button>\n\n\t\t\t<button\n\t\t\t\tdata-response=\"0\"\n\t\t\t\tdata-post=\"4167\"\n\t\t\t\tdata-post-url=\"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/postgresql-rank-function\/\"\n\t\t\t\tdata-post-title=\"PostgreSQL RANK Function\"\n\t\t\t\tclass=\"wth-btn-rounded wth-no-btn\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http:\/\/www.w3.org\/2000\/svg\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17\"\n\t\t\t\t\t><\/path>\n\t\t\t\t<\/svg>\n\t\t\t\t<span class=\"sr-only\"> No <\/span>\n\t\t\t<\/button>\n\t\t<\/div>\n\t<\/header>\n\n\t<div class=\"wth-form hidden\">\n\t\t<div class=\"wth-form-wrapper\">\n\t\t\t<div class=\"wth-title\"><\/div>\n\t\t\t<textarea class=\"wth-message\"><\/textarea>\n\t\t\t<input type=\"button\" name=\"wth-submit\" class=\"wth-btn wth-btn-submit\" id=\"wth-submit\" \/>\n\t\t\t<input type=\"button\" class=\"wth-btn wth-btn-cancel\" value=\"Cancel\" \/>\n\t\t<\/div>\n\t<\/div>\n<\/div>\n","protected":false},"excerpt":{"rendered":"<p>In this tutorial, you will learn how to use PostgreSQL RANK() function to assign a rank for every row of a result set.<\/p>\n","protected":false},"author":1,"featured_media":0,"parent":1737,"menu_order":9,"comment_status":"closed","ping_status":"closed","template":"","meta":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v19.0 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>PostgreSQL RANK() Function By Practical Examples<\/title>\n<meta name=\"description\" content=\"In this tutorial, you will learn how to use PostgreSQL RANK() function to assign a rank for every row of a result set.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/\" \/>\n<meta name=\"twitter:label1\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data1\" content=\"3 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/#website\",\"url\":\"https:\/\/www.postgresqltutorial.com\/\",\"name\":\"PostgreSQL Tutorial\",\"description\":\"Comprehensive Postgresql Tutorial\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/www.postgresqltutorial.com\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/#primaryimage\",\"url\":\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2019\/05\/PostgreSQL-RANK-function-sample-table.png\",\"contentUrl\":\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2019\/05\/PostgreSQL-RANK-function-sample-table.png\",\"width\":183,\"height\":212,\"caption\":\"PostgreSQL RANK function - sample table\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/#webpage\",\"url\":\"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/\",\"name\":\"PostgreSQL RANK() Function By Practical Examples\",\"isPartOf\":{\"@id\":\"https:\/\/www.postgresqltutorial.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/#primaryimage\"},\"datePublished\":\"2019-05-12T13:29:28+00:00\",\"dateModified\":\"2020-07-10T04:57:36+00:00\",\"description\":\"In this tutorial, you will learn how to use PostgreSQL RANK() function to assign a rank for every row of a result set.\",\"breadcrumb\":{\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https:\/\/www.postgresqltutorial.com\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"PostgreSQL Window Functions\",\"item\":\"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/\"},{\"@type\":\"ListItem\",\"position\":3,\"name\":\"PostgreSQL RANK Function\"}]}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"PostgreSQL RANK() Function By Practical Examples","description":"In this tutorial, you will learn how to use PostgreSQL RANK() function to assign a rank for every row of a result set.","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/","twitter_misc":{"Est. reading time":"3 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"https:\/\/www.postgresqltutorial.com\/#website","url":"https:\/\/www.postgresqltutorial.com\/","name":"PostgreSQL Tutorial","description":"Comprehensive Postgresql Tutorial","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/www.postgresqltutorial.com\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","inLanguage":"en-US","@id":"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/#primaryimage","url":"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2019\/05\/PostgreSQL-RANK-function-sample-table.png","contentUrl":"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2019\/05\/PostgreSQL-RANK-function-sample-table.png","width":183,"height":212,"caption":"PostgreSQL RANK function - sample table"},{"@type":"WebPage","@id":"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/#webpage","url":"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/","name":"PostgreSQL RANK() Function By Practical Examples","isPartOf":{"@id":"https:\/\/www.postgresqltutorial.com\/#website"},"primaryImageOfPage":{"@id":"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/#primaryimage"},"datePublished":"2019-05-12T13:29:28+00:00","dateModified":"2020-07-10T04:57:36+00:00","description":"In this tutorial, you will learn how to use PostgreSQL RANK() function to assign a rank for every row of a result set.","breadcrumb":{"@id":"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/www.postgresqltutorial.com\/"},{"@type":"ListItem","position":2,"name":"PostgreSQL Window Functions","item":"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/"},{"@type":"ListItem","position":3,"name":"PostgreSQL RANK Function"}]}]}},"_links":{"self":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/4167"}],"collection":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/comments?post=4167"}],"version-history":[{"count":1,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/4167\/revisions"}],"predecessor-version":[{"id":4585,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/4167\/revisions\/4585"}],"up":[{"embeddable":true,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/1737"}],"wp:attachment":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/media?parent=4167"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}