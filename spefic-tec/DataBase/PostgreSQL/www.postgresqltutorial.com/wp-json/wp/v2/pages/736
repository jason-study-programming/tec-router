{"id":736,"date":"2013-06-05T01:07:12","date_gmt":"2013-06-05T08:07:12","guid":{"rendered":"http:\/\/www.postgresqltutorial.com\/?page_id=736"},"modified":"2020-07-28T18:27:42","modified_gmt":"2020-07-29T01:27:42","slug":"postgresql-backup-database","status":"publish","type":"page","link":"https:\/\/www.postgresqltutorial.com\/postgresql-administration\/postgresql-backup-database\/","title":{"rendered":"PostgreSQL Backup"},"content":{"rendered":"\n<p><strong>Summary<\/strong>: in this tutorial, you will learn how to backup the PostgreSQL databases using the <code>pg_dump<\/code> and <code>pg_dumpall<\/code> tool.<\/p>\n\n\n\n<p>Backing up databases is one of the most critical tasks in database administration. Before backing up the databases, you should consider the following type of backups:<\/p>\n\n\n\n<ul><li>Full \/ partial databases<\/li><li>Both data and structures, or only structures<\/li><li>Point-in-time recovery<\/li><li>Restore performance<\/li><\/ul>\n\n\n\n<p>PostgreSQL comes with <code>pg_dump<\/code> and <code>pg_dumpall<\/code>tools that help you backup databases easily and effectively.<\/p>\n\n\n\n<p>For ones who want to see the command to backup databases quickly, here it is:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-1\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\">pg_dump -U username -W -F t database_name &gt; c:\\backup_file.tar<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-1\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>In the following section, you will learn step by step how to backup one database, all databases, and only database objects.<\/p>\n\n\n\n<h2>How to backup one database<\/h2>\n\n\n\n<p>To backup one database, you can use the&nbsp; <code>pg_dump<\/code> tool. The&nbsp; <code>pg_dump<\/code> dumps out the content of all database objects into a single file.<\/p>\n\n\n\n<p>First, navigate to PostgreSQL bin folder:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-2\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\">C:\\&gt;cd C:\\Program Files\\PostgreSQL\\12\\bin<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-2\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>Second, execute the&nbsp; <code>pg_dump<\/code> program and use the following options to backup the <code>dvdrental<\/code>database to the&nbsp; <code>dvdrental.tar<\/code> file in the&nbsp; <code>c:\\pgbackup\\<\/code> folder.<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-3\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\">pg_dump -U postgres -W -F t dvdrental &gt; c:\\pgbackup\\dvdrental.tar<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-3\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>Let&#8217;s examine the options in more detail.<\/p>\n\n\n\n<p><code>-U postgres<\/code>: &nbsp;specifies the user to connect to the PostgreSQL database server. We used the <code>postgres<\/code> in this example.<\/p>\n\n\n\n<p><code>-W<\/code>: \u00a0forces <code>pg_dump<\/code> to prompt for the password before connecting to the PostgreSQL database server. After you hit enter, <code>pg_dump<\/code> will prompt for the password of <code>postgres<\/code> user.<\/p>\n\n\n\n<p><code>-F<\/code>&nbsp;: specifies the output file format that can be one of the following:<\/p>\n\n\n\n<ul><li><code>c<\/code>: custom-format archive file format<\/li><li><code>d<\/code>: directory-format archive<\/li><li><code>t<\/code>: tar<\/li><li><code>p<\/code>: plain-text SQL script file).<\/li><\/ul>\n\n\n\n<p>In this example, we use\u00a0 <code>-F t<\/code>  to specify the output file as a tar file.<\/p>\n\n\n\n<p><code>dvdrental<\/code>: is the name of the database that you want to back up.<\/p>\n\n\n\n<p><code>&gt; c:\\pgbackup\\dvdrental.tar<\/code> is the output backup file path.<\/p>\n\n\n\n<h2>How to backup all databases<\/h2>\n\n\n\n<p>To back up all databases, you can run the individual\u00a0 <code>pg_dump<\/code> command above sequentially, or parallel if you want to speed up the backup process.<\/p>\n\n\n\n<ul><li>First, from the psql, use the command&nbsp; <code>\\list<\/code> to list all available databases in your cluster<\/li><li>Second, back up each individual database using the &nbsp;<code>pg_dump<\/code> program as described in the above section.<\/li><\/ul>\n\n\n\n<p>Besides the\u00a0 <code>pg_dump<\/code> program, PostgreSQL also provides you with the <code>pg_dumpall<\/code> tool that allows you to backup all databases at once. However, it is not recommended to use this tool because of the following reasons:<\/p>\n\n\n\n<ul><li>The\u00a0 <code>pg_dumpall<\/code> program exports all databases, one after another, into a single script file, which prevents you from performing the parallel restore. If you back up all databases this way, the restore process will take more time.<\/li><li>The processing of dumping all databases takes longer than each individual one so you do not know which dump of each database relates to a specific point in time.<\/li><\/ul>\n\n\n\n<p>If you have a good reason to use the <code>pg_dumpall<\/code>to backup all databases, the following is the command:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-4\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\">pg_dumpall -U postgres &gt; c:\\pgbackup\\all.sql<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-4\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>The options of the\u00a0 <code>pg_dumpall<\/code> program are similar to the options of the <code>pg_dump<\/code> program. This command omits the <code>-W<\/code> option to avoid typing the password for each individual database.<\/p>\n\n\n\n<h2>How to backup database object definitions<\/h2>\n\n\n\n<p>Sometimes, you want to backup only database object definitions, not the data This is helpful in the testing phase, which you do not want to move test data to the live system.<\/p>\n\n\n\n<p>To back up objects in all databases, including roles, tablespaces, databases, schemas, tables, indexes, triggers, functions, constraints, views, ownerships, and privileges, you use the following command:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-5\" data-shcb-language-name=\"CSS\" data-shcb-language-slug=\"css\"><div><code class=\"hljs language-css\"><span class=\"hljs-selector-tag\">pg_dumpall<\/span> <span class=\"hljs-selector-tag\">--schema-only<\/span> &gt; <span class=\"hljs-selector-tag\">c<\/span>:\\<span class=\"hljs-selector-tag\">pgdump<\/span>\\<span class=\"hljs-selector-tag\">definitiononly<\/span><span class=\"hljs-selector-class\">.sql<\/span><\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-5\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">CSS<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">css<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>If you want to back up role definition only, use the following command:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-6\" data-shcb-language-name=\"CSS\" data-shcb-language-slug=\"css\"><div><code class=\"hljs language-css\"><span class=\"hljs-selector-tag\">pg_dumpall<\/span> <span class=\"hljs-selector-tag\">--roles-only<\/span> &gt; <span class=\"hljs-selector-tag\">c<\/span>:\\<span class=\"hljs-selector-tag\">pgdump<\/span>\\<span class=\"hljs-selector-tag\">allroles<\/span><span class=\"hljs-selector-class\">.sql<\/span><\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-6\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">CSS<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">css<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>If you want to backup <a title=\"PostgreSQL Tablespaces\" href=\"https:\/\/www.postgresqltutorial.com\/postgresql-create-tablespace\/\">tablespaces <\/a>definition, use the following command:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-7\" data-shcb-language-name=\"CSS\" data-shcb-language-slug=\"css\"><div><code class=\"hljs language-css\"><span class=\"hljs-selector-tag\">pg_dumpall<\/span> <span class=\"hljs-selector-tag\">--tablespaces-only<\/span> &gt; <span class=\"hljs-selector-tag\">c<\/span>:\\<span class=\"hljs-selector-tag\">pgdump<\/span>\\<span class=\"hljs-selector-tag\">allroles<\/span><span class=\"hljs-selector-class\">.sql<\/span><\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-7\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">CSS<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">css<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<h2>Further Reading<\/h2>\n\n\n\n<ul><li><a href=\"https:\/\/www.postgresql.org\/docs\/current\/app-pgdump.html\">https:\/\/www.postgresql.org\/docs\/current\/app-pgdump.html<\/a> &#8211; How to use the&nbsp;<code>pg_dump<\/code>tool.<\/li><\/ul>\n<div class=\"helpful-block-content\" data-title=\"\">\n\t<header>\n\t\t<div class=\"wth-question\">Was this tutorial helpful ?<\/div>\n\t\t<div class=\"wth-thumbs\">\n\t\t\t<button\n\t\t\t\tdata-post=\"736\"\n\t\t\t\tdata-post-url=\"https:\/\/www.postgresqltutorial.com\/postgresql-administration\/postgresql-backup-database\/\"\n\t\t\t\tdata-post-title=\"PostgreSQL Backup\"\n\t\t\t\tdata-response=\"1\"\n\t\t\t\tclass=\"wth-btn-rounded wth-yes-btn\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http:\/\/www.w3.org\/2000\/svg\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\tclass=\"feather feather-thumbs-up block w-full h-full\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3\"\n\t\t\t\t\t><\/path>\n\t\t\t\t<\/svg>\n\t\t\t\t<span class=\"sr-only\"> Yes <\/span>\n\t\t\t<\/button>\n\n\t\t\t<button\n\t\t\t\tdata-response=\"0\"\n\t\t\t\tdata-post=\"736\"\n\t\t\t\tdata-post-url=\"https:\/\/www.postgresqltutorial.com\/postgresql-administration\/postgresql-backup-database\/\"\n\t\t\t\tdata-post-title=\"PostgreSQL Backup\"\n\t\t\t\tclass=\"wth-btn-rounded wth-no-btn\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http:\/\/www.w3.org\/2000\/svg\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17\"\n\t\t\t\t\t><\/path>\n\t\t\t\t<\/svg>\n\t\t\t\t<span class=\"sr-only\"> No <\/span>\n\t\t\t<\/button>\n\t\t<\/div>\n\t<\/header>\n\n\t<div class=\"wth-form hidden\">\n\t\t<div class=\"wth-form-wrapper\">\n\t\t\t<div class=\"wth-title\"><\/div>\n\t\t\t<textarea class=\"wth-message\"><\/textarea>\n\t\t\t<input type=\"button\" name=\"wth-submit\" class=\"wth-btn wth-btn-submit\" id=\"wth-submit\" \/>\n\t\t\t<input type=\"button\" class=\"wth-btn wth-btn-cancel\" value=\"Cancel\" \/>\n\t\t<\/div>\n\t<\/div>\n<\/div>\n","protected":false},"excerpt":{"rendered":"<p>Summary: in this tutorial, you will learn how to backup the PostgreSQL databases using the pg_dump and pg_dumpall tool. Backing up databases is one of the most critical tasks in database administration. Before backing up the databases, you should consider the following type of backups: Full \/ partial databases Both data and structures, or only [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"parent":657,"menu_order":21,"comment_status":"open","ping_status":"open","template":"","meta":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v19.0 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Backup Databases Using PostgreSQL Backup Tools: pg_dump &amp; pg_dumpall<\/title>\n<meta name=\"description\" content=\"This tutorial shows you how to use PostgreSQL backup tools including pg_dump and pg_dumpall to backup databases in PostgreSQL.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.postgresqltutorial.com\/postgresql-backup-database\/\" \/>\n<meta name=\"twitter:label1\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data1\" content=\"3 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/#website\",\"url\":\"https:\/\/www.postgresqltutorial.com\/\",\"name\":\"PostgreSQL Tutorial\",\"description\":\"Comprehensive Postgresql Tutorial\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/www.postgresqltutorial.com\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-backup-database\/#webpage\",\"url\":\"https:\/\/www.postgresqltutorial.com\/postgresql-backup-database\/\",\"name\":\"Backup Databases Using PostgreSQL Backup Tools: pg_dump & pg_dumpall\",\"isPartOf\":{\"@id\":\"https:\/\/www.postgresqltutorial.com\/#website\"},\"datePublished\":\"2013-06-05T08:07:12+00:00\",\"dateModified\":\"2020-07-29T01:27:42+00:00\",\"description\":\"This tutorial shows you how to use PostgreSQL backup tools including pg_dump and pg_dumpall to backup databases in PostgreSQL.\",\"breadcrumb\":{\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-backup-database\/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.postgresqltutorial.com\/postgresql-backup-database\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-backup-database\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https:\/\/www.postgresqltutorial.com\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"PostgreSQL Administration\",\"item\":\"https:\/\/www.postgresqltutorial.com\/postgresql-administration\/\"},{\"@type\":\"ListItem\",\"position\":3,\"name\":\"PostgreSQL Backup\"}]}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Backup Databases Using PostgreSQL Backup Tools: pg_dump & pg_dumpall","description":"This tutorial shows you how to use PostgreSQL backup tools including pg_dump and pg_dumpall to backup databases in PostgreSQL.","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/www.postgresqltutorial.com\/postgresql-backup-database\/","twitter_misc":{"Est. reading time":"3 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"https:\/\/www.postgresqltutorial.com\/#website","url":"https:\/\/www.postgresqltutorial.com\/","name":"PostgreSQL Tutorial","description":"Comprehensive Postgresql Tutorial","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/www.postgresqltutorial.com\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"WebPage","@id":"https:\/\/www.postgresqltutorial.com\/postgresql-backup-database\/#webpage","url":"https:\/\/www.postgresqltutorial.com\/postgresql-backup-database\/","name":"Backup Databases Using PostgreSQL Backup Tools: pg_dump & pg_dumpall","isPartOf":{"@id":"https:\/\/www.postgresqltutorial.com\/#website"},"datePublished":"2013-06-05T08:07:12+00:00","dateModified":"2020-07-29T01:27:42+00:00","description":"This tutorial shows you how to use PostgreSQL backup tools including pg_dump and pg_dumpall to backup databases in PostgreSQL.","breadcrumb":{"@id":"https:\/\/www.postgresqltutorial.com\/postgresql-backup-database\/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/www.postgresqltutorial.com\/postgresql-backup-database\/"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/www.postgresqltutorial.com\/postgresql-backup-database\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/www.postgresqltutorial.com\/"},{"@type":"ListItem","position":2,"name":"PostgreSQL Administration","item":"https:\/\/www.postgresqltutorial.com\/postgresql-administration\/"},{"@type":"ListItem","position":3,"name":"PostgreSQL Backup"}]}]}},"_links":{"self":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/736"}],"collection":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/comments?post=736"}],"version-history":[{"count":5,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/736\/revisions"}],"predecessor-version":[{"id":5627,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/736\/revisions\/5627"}],"up":[{"embeddable":true,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/657"}],"wp:attachment":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/media?parent=736"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}