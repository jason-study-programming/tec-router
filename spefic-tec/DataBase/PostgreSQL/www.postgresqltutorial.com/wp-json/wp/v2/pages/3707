{"id":3707,"date":"2018-12-02T04:52:12","date_gmt":"2018-12-02T11:52:12","guid":{"rendered":"http:\/\/www.postgresqltutorial.com\/?page_id=3707"},"modified":"2020-08-02T06:06:25","modified_gmt":"2020-08-02T13:06:25","slug":"postgresql-create-index","status":"publish","type":"page","link":"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/","title":{"rendered":"PostgreSQL CREATE INDEX"},"content":{"rendered":"\n<p><strong>Summary<\/strong>: in this tutorial, you will learn about indexes and how to use the PostgreSQL <code>CREATE INDEX<\/code> statement to define a new index for a table.<\/p>\n\n\n\n<h2>Phonebook analogy and index<\/h2>\n\n\n\n<p>Assuming that you need to look up for John Doe&#8217;s phone number on a phone book. With the understanding that names on the phone book are in alphabetically order, you first look for the page where the last name is Doe, then look for first name John, and finally get his phone number.<\/p>\n\n\n\n<p>Suppose the names on the phone book were not ordered alphabetically, you would have to go through all pages, check every name until you find John Doe&#8217;s phone number. This is called sequential scan which you go over all entries until you find the one that you are looking for.<\/p>\n\n\n\n<p>Similar to a phonebook, the data stored in the table should be organized in a particular order to speed up various searches. This is why indexes come into play.<\/p>\n\n\n\n<p>An index is a separated data structure e.g., B-Tree that speeds up the data retrieval on a table at the cost of additional writes and storage to maintain it.<\/p>\n\n\n\n<h2>PostgreSQL <code>CREATE INDEX<\/code> overview<\/h2>\n\n\n\n<p>A simple version of <code>CREATE INDEX<\/code> statement is as follows:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-1\" data-shcb-language-name=\"CSS\" data-shcb-language-slug=\"css\"><div><code class=\"hljs language-css\"><span class=\"hljs-selector-tag\">CREATE<\/span> <span class=\"hljs-selector-tag\">INDEX<\/span> <span class=\"hljs-selector-tag\">index_name<\/span> <span class=\"hljs-selector-tag\">ON<\/span> <span class=\"hljs-selector-tag\">table_name<\/span> <span class=\"hljs-selector-attr\">[USING method]<\/span>\n(\n    <span class=\"hljs-selector-tag\">column_name<\/span> <span class=\"hljs-selector-attr\">[ASC | DESC]<\/span> <span class=\"hljs-selector-attr\">[NULLS {FIRST | LAST }]<\/span>,\n    ...\n);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-1\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">CSS<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">css<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>In this syntax:<\/p>\n\n\n\n<ul><li>First, specify the index name after the <code>CREATE INDEX<\/code> clause. The index name should be meaningful and easy to remember.<\/li><li>Second, specify the name of the table to which the index belongs.<\/li><li>Third, specify the index method such as <code>btree<\/code>, <code>hash<\/code>, <code>gist<\/code>, <code>spgist<\/code>, <code>gin<\/code>, and <code>brin<\/code>. PostgreSQL uses <code>btree<\/code> by default.<\/li><li>Fourth, list one or more columns that to be stored in the index. The <code>ASC<\/code> and <code>DESC<\/code> specify the sort order. ASC is the default. <code>NULLS FIRST<\/code> or <code>NULLS LAST<\/code> specifies nulls sort before or after non-nulls. The <code>NULLS FIRST<\/code> is the default when <code>DESC<\/code> is specified and <code>NULLS LAST<\/code> is the default when <code>DESC<\/code> is not specified.<\/li><\/ul>\n\n\n\n<p>To check if a query uses an index or not, you use the <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-explain\/\">EXPLAIN<\/a><\/code> statement.<\/p>\n\n\n\n<h2>PostgreSQL <code>CREATE INDEX<\/code> example<\/h2>\n\n\n\n<p>We will use the <code>address<\/code> table from the <a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-sample-database\/\">sample database<\/a> for the demonstration.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"181\" height=\"219\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/address.png\" alt=\"address table\" class=\"wp-image-3708\"\/><\/figure>\n\n\n\n<p>The following <a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-select\/\">query<\/a> finds the address whose phone number is <code>223664661973<\/code>:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-2\" data-shcb-language-name=\"JavaScript\" data-shcb-language-slug=\"javascript\"><div><code class=\"hljs language-javascript\">SELECT * FROM address\nWHERE phone = <span class=\"hljs-string\">'223664661973'<\/span>;<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-2\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">JavaScript<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">javascript<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>It is obvious that the database engine had to scan the whole <code>address<\/code> table to look for the address because there is no index available for the <code>phone<\/code> column.<\/p>\n\n\n\n<p>To show the query plan, you use the <code>EXPLAIN<\/code> statement as follows:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-3\" data-shcb-language-name=\"JavaScript\" data-shcb-language-slug=\"javascript\"><div><code class=\"hljs language-javascript\">EXPLAIN SELECT *\nFROM address\nWHERE phone = <span class=\"hljs-string\">'223664661973'<\/span>;<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-3\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">JavaScript<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">javascript<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>Here is the output:<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"316\" height=\"51\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/PostgreSQL-CREATE-INDEX-sequential-scan-example.png\" alt=\"PostgreSQL CREATE INDEX - sequential scan example\" class=\"wp-image-3709\"\/><\/figure>\n\n\n\n<p>To create an index for the values in the <code>phone<\/code> column of the <code>address<\/code> table, you use the following statement:<\/p>\n\n\n<pre class=\"wp-block-code\"><div><code class=\"hljs\">CREATE INDEX idx_address_phone \nON address(phone);<\/code><\/div><\/pre>\n\n\n<p>Now, if you execute the query again, you will find that the database engine uses the index for lookup:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-4\" data-shcb-language-name=\"JavaScript\" data-shcb-language-slug=\"javascript\"><div><code class=\"hljs language-javascript\">EXPLAIN SELECT *\nFROM address\nWHERE phone = <span class=\"hljs-string\">'223664661973'<\/span>;<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-4\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">JavaScript<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">javascript<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>The following shows the output:<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"437\" height=\"53\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/PostgreSQL-CREATE-INDEX-index-scan-example.png\" alt=\"PostgreSQL CREATE INDEX - index scan example\" class=\"wp-image-3710\"\/><\/figure>\n\n\n\n<p>In this tutorial, you have learned about indexes and how to use the PostgreSQL <code>CREATE INDEX<\/code> to define an index for a table.<\/p>\n<div class=\"helpful-block-content\" data-title=\"\">\n\t<header>\n\t\t<div class=\"wth-question\">Was this tutorial helpful ?<\/div>\n\t\t<div class=\"wth-thumbs\">\n\t\t\t<button\n\t\t\t\tdata-post=\"3707\"\n\t\t\t\tdata-post-url=\"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/\"\n\t\t\t\tdata-post-title=\"PostgreSQL CREATE INDEX\"\n\t\t\t\tdata-response=\"1\"\n\t\t\t\tclass=\"wth-btn-rounded wth-yes-btn\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http:\/\/www.w3.org\/2000\/svg\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\tclass=\"feather feather-thumbs-up block w-full h-full\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3\"\n\t\t\t\t\t><\/path>\n\t\t\t\t<\/svg>\n\t\t\t\t<span class=\"sr-only\"> Yes <\/span>\n\t\t\t<\/button>\n\n\t\t\t<button\n\t\t\t\tdata-response=\"0\"\n\t\t\t\tdata-post=\"3707\"\n\t\t\t\tdata-post-url=\"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/\"\n\t\t\t\tdata-post-title=\"PostgreSQL CREATE INDEX\"\n\t\t\t\tclass=\"wth-btn-rounded wth-no-btn\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http:\/\/www.w3.org\/2000\/svg\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17\"\n\t\t\t\t\t><\/path>\n\t\t\t\t<\/svg>\n\t\t\t\t<span class=\"sr-only\"> No <\/span>\n\t\t\t<\/button>\n\t\t<\/div>\n\t<\/header>\n\n\t<div class=\"wth-form hidden\">\n\t\t<div class=\"wth-form-wrapper\">\n\t\t\t<div class=\"wth-title\"><\/div>\n\t\t\t<textarea class=\"wth-message\"><\/textarea>\n\t\t\t<input type=\"button\" name=\"wth-submit\" class=\"wth-btn wth-btn-submit\" id=\"wth-submit\" \/>\n\t\t\t<input type=\"button\" class=\"wth-btn wth-btn-cancel\" value=\"Cancel\" \/>\n\t\t<\/div>\n\t<\/div>\n<\/div>\n","protected":false},"excerpt":{"rendered":"<p>In this tutorial, you will learn about indexes and how to use the PostgreSQL CREATE INDEX statement to define a new index for a table.<\/p>\n","protected":false},"author":1,"featured_media":0,"parent":3705,"menu_order":0,"comment_status":"closed","ping_status":"closed","template":"","meta":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v19.0 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>PostgreSQL CREATE INDEX By Practical Examples<\/title>\n<meta name=\"description\" content=\"In this tutorial, you will learn about indexes and how to use the PostgreSQL CREATE INDEX statement to define a new index for a table.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/\" \/>\n<meta name=\"twitter:label1\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data1\" content=\"3 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/#website\",\"url\":\"https:\/\/www.postgresqltutorial.com\/\",\"name\":\"PostgreSQL Tutorial\",\"description\":\"Comprehensive Postgresql Tutorial\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/www.postgresqltutorial.com\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/#primaryimage\",\"url\":\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/address.png\",\"contentUrl\":\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/address.png\",\"width\":181,\"height\":219,\"caption\":\"address table\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/#webpage\",\"url\":\"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/\",\"name\":\"PostgreSQL CREATE INDEX By Practical Examples\",\"isPartOf\":{\"@id\":\"https:\/\/www.postgresqltutorial.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/#primaryimage\"},\"datePublished\":\"2018-12-02T11:52:12+00:00\",\"dateModified\":\"2020-08-02T13:06:25+00:00\",\"description\":\"In this tutorial, you will learn about indexes and how to use the PostgreSQL CREATE INDEX statement to define a new index for a table.\",\"breadcrumb\":{\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https:\/\/www.postgresqltutorial.com\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"PostgreSQL Indexes\",\"item\":\"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/\"},{\"@type\":\"ListItem\",\"position\":3,\"name\":\"PostgreSQL CREATE INDEX\"}]}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"PostgreSQL CREATE INDEX By Practical Examples","description":"In this tutorial, you will learn about indexes and how to use the PostgreSQL CREATE INDEX statement to define a new index for a table.","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/","twitter_misc":{"Est. reading time":"3 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"https:\/\/www.postgresqltutorial.com\/#website","url":"https:\/\/www.postgresqltutorial.com\/","name":"PostgreSQL Tutorial","description":"Comprehensive Postgresql Tutorial","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/www.postgresqltutorial.com\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","inLanguage":"en-US","@id":"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/#primaryimage","url":"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/address.png","contentUrl":"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/address.png","width":181,"height":219,"caption":"address table"},{"@type":"WebPage","@id":"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/#webpage","url":"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/","name":"PostgreSQL CREATE INDEX By Practical Examples","isPartOf":{"@id":"https:\/\/www.postgresqltutorial.com\/#website"},"primaryImageOfPage":{"@id":"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/#primaryimage"},"datePublished":"2018-12-02T11:52:12+00:00","dateModified":"2020-08-02T13:06:25+00:00","description":"In this tutorial, you will learn about indexes and how to use the PostgreSQL CREATE INDEX statement to define a new index for a table.","breadcrumb":{"@id":"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/postgresql-create-index\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/www.postgresqltutorial.com\/"},{"@type":"ListItem","position":2,"name":"PostgreSQL Indexes","item":"https:\/\/www.postgresqltutorial.com\/postgresql-indexes\/"},{"@type":"ListItem","position":3,"name":"PostgreSQL CREATE INDEX"}]}]}},"_links":{"self":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/3707"}],"collection":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/comments?post=3707"}],"version-history":[{"count":2,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/3707\/revisions"}],"predecessor-version":[{"id":4540,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/3707\/revisions\/4540"}],"up":[{"embeddable":true,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/3705"}],"wp:attachment":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/media?parent=3707"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}