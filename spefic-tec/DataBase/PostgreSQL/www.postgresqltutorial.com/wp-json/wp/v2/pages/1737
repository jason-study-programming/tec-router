{"id":1737,"date":"2016-06-19T22:02:39","date_gmt":"2016-06-20T05:02:39","guid":{"rendered":"http:\/\/www.postgresqltutorial.com\/?page_id=1737"},"modified":"2021-04-26T18:56:11","modified_gmt":"2021-04-27T01:56:11","slug":"postgresql-window-function","status":"publish","type":"page","link":"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/","title":{"rendered":"PostgreSQL Window Functions"},"content":{"rendered":"\n<p><strong>Summary<\/strong>: in this tutorial, you will learn how to use the PostgreSQL window functions to perform the calculation across a set of rows related to the current row.<\/p>\n\n\n\n<h2>Setting up sample tables<\/h2>\n\n\n\n<p>First, <a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-create-table\/\">create two tables<\/a> named <code>products<\/code> and <code>product_groups<\/code> for the demonstration:<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"540\" height=\"173\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2016\/06\/products_product_groups_tables.png\" alt=\"\" class=\"wp-image-2268\" srcset=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2016\/06\/products_product_groups_tables.png 540w, https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2016\/06\/products_product_groups_tables-300x96.png 300w\" sizes=\"(max-width: 540px) 100vw, 540px\" \/><\/figure>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-1\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">CREATE<\/span> <span class=\"hljs-keyword\">TABLE<\/span> product_groups (\n\t<span class=\"hljs-keyword\">group_id<\/span> <span class=\"hljs-built_in\">serial<\/span> PRIMARY <span class=\"hljs-keyword\">KEY<\/span>,\n\tgroup_name <span class=\"hljs-built_in\">VARCHAR<\/span> (<span class=\"hljs-number\">255<\/span>) <span class=\"hljs-keyword\">NOT<\/span> <span class=\"hljs-literal\">NULL<\/span>\n);\n\n<span class=\"hljs-keyword\">CREATE<\/span> <span class=\"hljs-keyword\">TABLE<\/span> products (\n\tproduct_id <span class=\"hljs-built_in\">serial<\/span> PRIMARY <span class=\"hljs-keyword\">KEY<\/span>,\n\tproduct_name <span class=\"hljs-built_in\">VARCHAR<\/span> (<span class=\"hljs-number\">255<\/span>) <span class=\"hljs-keyword\">NOT<\/span> <span class=\"hljs-literal\">NULL<\/span>,\n\tprice <span class=\"hljs-built_in\">DECIMAL<\/span> (<span class=\"hljs-number\">11<\/span>, <span class=\"hljs-number\">2<\/span>),\n\t<span class=\"hljs-keyword\">group_id<\/span> <span class=\"hljs-built_in\">INT<\/span> <span class=\"hljs-keyword\">NOT<\/span> <span class=\"hljs-literal\">NULL<\/span>,\n\t<span class=\"hljs-keyword\">FOREIGN<\/span> <span class=\"hljs-keyword\">KEY<\/span> (<span class=\"hljs-keyword\">group_id<\/span>) <span class=\"hljs-keyword\">REFERENCES<\/span> product_groups (<span class=\"hljs-keyword\">group_id<\/span>)\n);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-1\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>Second, <a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-insert\/\">insert<\/a> some rows into these tables:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-2\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">INSERT<\/span> <span class=\"hljs-keyword\">INTO<\/span> product_groups (group_name)\n<span class=\"hljs-keyword\">VALUES<\/span>\n\t(<span class=\"hljs-string\">'Smartphone'<\/span>),\n\t(<span class=\"hljs-string\">'Laptop'<\/span>),\n\t(<span class=\"hljs-string\">'Tablet'<\/span>);\n\n<span class=\"hljs-keyword\">INSERT<\/span> <span class=\"hljs-keyword\">INTO<\/span> products (product_name, <span class=\"hljs-keyword\">group_id<\/span>,price)\n<span class=\"hljs-keyword\">VALUES<\/span>\n\t(<span class=\"hljs-string\">'Microsoft Lumia'<\/span>, <span class=\"hljs-number\">1<\/span>, <span class=\"hljs-number\">200<\/span>),\n\t(<span class=\"hljs-string\">'HTC One'<\/span>, <span class=\"hljs-number\">1<\/span>, <span class=\"hljs-number\">400<\/span>),\n\t(<span class=\"hljs-string\">'Nexus'<\/span>, <span class=\"hljs-number\">1<\/span>, <span class=\"hljs-number\">500<\/span>),\n\t(<span class=\"hljs-string\">'iPhone'<\/span>, <span class=\"hljs-number\">1<\/span>, <span class=\"hljs-number\">900<\/span>),\n\t(<span class=\"hljs-string\">'HP Elite'<\/span>, <span class=\"hljs-number\">2<\/span>, <span class=\"hljs-number\">1200<\/span>),\n\t(<span class=\"hljs-string\">'Lenovo Thinkpad'<\/span>, <span class=\"hljs-number\">2<\/span>, <span class=\"hljs-number\">700<\/span>),\n\t(<span class=\"hljs-string\">'Sony VAIO'<\/span>, <span class=\"hljs-number\">2<\/span>, <span class=\"hljs-number\">700<\/span>),\n\t(<span class=\"hljs-string\">'Dell Vostro'<\/span>, <span class=\"hljs-number\">2<\/span>, <span class=\"hljs-number\">800<\/span>),\n\t(<span class=\"hljs-string\">'iPad'<\/span>, <span class=\"hljs-number\">3<\/span>, <span class=\"hljs-number\">700<\/span>),\n\t(<span class=\"hljs-string\">'Kindle Fire'<\/span>, <span class=\"hljs-number\">3<\/span>, <span class=\"hljs-number\">150<\/span>),\n\t(<span class=\"hljs-string\">'Samsung Galaxy Tab'<\/span>, <span class=\"hljs-number\">3<\/span>, <span class=\"hljs-number\">200<\/span>);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-2\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"480\" height=\"313\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2019\/05\/products-table-sample-data.png\" alt=\"\" class=\"wp-image-4170\"\/><\/figure>\n\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"272\" height=\"109\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2019\/05\/product_groups-table-data.png\" alt=\"\" class=\"wp-image-4199\"\/><\/figure>\n\n\n\n<h2>Introduction to PostgreSQL window functions<\/h2>\n\n\n\n<p>The easiest way to understand the window functions is to start by reviewing the <a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-aggregate-functions\/\">aggregate functions<\/a>. An aggregate function aggregates data from a set of rows into a single row.<\/p>\n\n\n\n<p>The following example uses the <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-avg-function\/\">AVG()<\/a><\/code> aggregate function to calculate the average price of all products in the <code>products<\/code>&nbsp;table.<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-3\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span>\n\t<span class=\"hljs-keyword\">AVG<\/span> (price)\n<span class=\"hljs-keyword\">FROM<\/span>\n\tproducts;\n<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-3\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"137\" height=\"34\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/PostgreSQL-Window-Function-AVG-function.png\" alt=\"PostgreSQL Window Function - AVG function\" class=\"wp-image-3660\"\/><\/figure>\n\n\n\n<p>To apply the aggregate function to subsets of rows, you use the <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-group-by\/\">GROUP BY<\/a><\/code> clause. The following example returns the average price for every product group.<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-4\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span>\n\tgroup_name,\n\t<span class=\"hljs-keyword\">AVG<\/span> (price)\n<span class=\"hljs-keyword\">FROM<\/span>\n\tproducts\n<span class=\"hljs-keyword\">INNER<\/span> <span class=\"hljs-keyword\">JOIN<\/span> product_groups <span class=\"hljs-keyword\">USING<\/span> (<span class=\"hljs-keyword\">group_id<\/span>)\n<span class=\"hljs-keyword\">GROUP<\/span> <span class=\"hljs-keyword\">BY<\/span>\n\tgroup_name;<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-4\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"224\" height=\"67\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/PostgreSQL-Window-Function-AVG-function-with-GROUP-BY.png\" alt=\"PostgreSQL Window Function - AVG function with GROUP BY\" class=\"wp-image-3659\"\/><\/figure>\n\n\n\n<p>As you see clearly from the output, the <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-avg-function\/\">AVG()<\/a><\/code> function reduces the number of rows returned by the queries in both examples.<\/p>\n\n\n\n<p>Similar to an aggregate function, a window function operates on a set of rows. However, it does not reduce the number of rows returned by the query.<\/p>\n\n\n\n<p>The term <em>window<\/em> describes the set of rows on which the window function operates. A window function returns values from the rows in a window.<\/p>\n\n\n\n<p>For instance, the following query returns the product name, the price, product group name, along with the average prices of each product group.<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-5\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span>\n\tproduct_name,\n\tprice,\n\tgroup_name,\n\t<span class=\"hljs-keyword\">AVG<\/span> (price) <span class=\"hljs-keyword\">OVER<\/span> (\n\t   <span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> group_name\n\t)\n<span class=\"hljs-keyword\">FROM<\/span>\n\tproducts\n\t<span class=\"hljs-keyword\">INNER<\/span> <span class=\"hljs-keyword\">JOIN<\/span> \n\t\tproduct_groups <span class=\"hljs-keyword\">USING<\/span> (<span class=\"hljs-keyword\">group_id<\/span>);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-5\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"412\" height=\"217\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/PostgreSQL-Window-Function-AVG-window-function.png\" alt=\"\" class=\"wp-image-3661\"\/><\/figure>\n\n\n\n<p>In this query, the <code>AVG()<\/code> function works as a <em>window function<\/em> that operates on a set of rows specified by the <code>OVER<\/code> clause. Each set of rows is called a window.<\/p>\n\n\n\n<p>The new syntax for this query is the <code>OVER<\/code> clause:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-6\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\">AVG(price) OVER (PARTITION BY group_name)<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-6\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>In this syntax, the <code>PARTITION BY<\/code> distributes the rows of the result set into groups and the <code>AVG()<\/code> function is applied to each group to return the average price for each.<\/p>\n\n\n\n<p>Note that a window function always performs the calculation on the result set after the <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-joins\/\">JOIN<\/a><\/code>, <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-where\/\">WHERE<\/a><\/code>, <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-group-by\/\">GROUP BY<\/a><\/code> and <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-having\/\">HAVING<\/a><\/code> clause and before the final <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-order-by\/\">ORDER BY<\/a><\/code> clause in the evaluation order.<\/p>\n\n\n\n<h2>PostgreSQL Window Function Syntax<\/h2>\n\n\n\n<p>PostgreSQL has a sophisticated <a href=\"https:\/\/www.postgresql.org\/docs\/current\/sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS\">syntax for window function call<\/a>. The following illustrates the simplified version:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-7\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\">window_function(arg1, arg2,..) OVER (\n   [PARTITION BY partition_expression]\n   [ORDER BY sort_expression [ASC | DESC] [NULLS {FIRST | LAST }])  <\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-7\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>In this syntax:<\/p>\n\n\n\n<h3><code>window_function(arg1,arg2,...)<\/code><\/h3>\n\n\n\n<p>The <code>window_function<\/code> is the name of the window function. Some window functions do not accept any argument.<\/p>\n\n\n\n<h3><code>PARTITION BY<\/code> clause<\/h3>\n\n\n\n<p>The <code>PARTITION BY<\/code> clause divides rows into multiple groups or partitions to which the window function is applied. Like the example above, we used the product group to divide the products into groups (or partitions).<\/p>\n\n\n\n<p>The <code>PARTITION BY<\/code> clause is optional. If you skip the <code>PARTITION BY<\/code> clause, the window function will treat the whole result set as a single partition.<\/p>\n\n\n\n<h3><code>ORDER BY<\/code> clause<\/h3>\n\n\n\n<p>The <code>ORDER BY<\/code> clause specifies the order of rows in each partition to which the window function is applied.<\/p>\n\n\n\n<p>The <code>ORDER BY<\/code> clause uses the <code>NULLS FIRST<\/code> or <code>NULLS LAST<\/code> option to specify whether nullable values should be first or last in the result set. The default is <code>NULLS LAST<\/code> option.<\/p>\n\n\n\n<h3>&nbsp;<code>frame_clause<\/code><\/h3>\n\n\n\n<p>The <code>frame_clause<\/code> defines a subset of rows in the current partition to which the window function is applied. This subset of rows is called a frame.<\/p>\n\n\n\n<p>If you use multiple window functions in a query:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-8\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span>\n    wf1() <span class=\"hljs-keyword\">OVER<\/span>(<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> c1 <span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span> c2),\n    wf2() <span class=\"hljs-keyword\">OVER<\/span>(<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> c1 <span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span> c2)\n<span class=\"hljs-keyword\">FROM<\/span> table_name;<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-8\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>you can use the <code>WINDOW<\/code> clause to shorten the query as shown in the following query:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-9\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span> \n   wf1() <span class=\"hljs-keyword\">OVER<\/span> w,\n   wf2() <span class=\"hljs-keyword\">OVER<\/span> w,\n<span class=\"hljs-keyword\">FROM<\/span> table_name\n<span class=\"hljs-keyword\">WINDOW<\/span> w <span class=\"hljs-keyword\">AS<\/span> (<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> c1 <span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span> c2);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-9\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>It is also possible to use the <code>WINDOW<\/code> clause even though you call one window function in a query:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-10\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span> wf1() <span class=\"hljs-keyword\">OVER<\/span> w\n<span class=\"hljs-keyword\">FROM<\/span> table_name \n<span class=\"hljs-keyword\">WINDOW<\/span> w <span class=\"hljs-keyword\">AS<\/span> (<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> c1 <span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span> c2);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-10\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<h2>PostgreSQL window function List<\/h2>\n\n\n\n<p>The following table lists all window functions provided by PostgreSQL. Note that some aggregate functions such as <code>AVG()<\/code>, <code>MIN()<\/code>, <code>MAX()<\/code>, <code>SUM()<\/code>, and <code>COUNT()<\/code> can be also used as window functions.<\/p>\n\n\n\n<h2><input id=\"search\" class=\"light-table-filter\" type=\"text\" placeholder=\"Type a window function name to search...\" data-table=\"functions\"><\/h2>\n\n\n\n<figure class=\"wp-block-table responsive functions\"><table><thead><tr><th>Name<\/th><th>Description<\/th><\/tr><\/thead><tbody><tr><td><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-cume_dist-function\/\">CUME_DIST<\/a><\/td><td>Return the relative rank of the current row.<\/td><\/tr><tr><td><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-dense_rank-function\/\">DENSE_RANK<\/a><\/td><td>Rank the current row within its partition without gaps.<\/td><\/tr><tr><td><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-first_value-function\/\">FIRST_VALUE<\/a><\/td><td>Return a value evaluated against the first row within its partition.<\/td><\/tr><tr><td><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-lag-function\/\">LAG<\/a><\/td><td>Return a value evaluated at the row that is at a specified physical offset row before the current row within the partition.<\/td><\/tr><tr><td><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-last_value-function\/\">LAST_VALUE<\/a><\/td><td>Return a value evaluated against the last row within its partition.<\/td><\/tr><tr><td><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-lead-function\/\">LEAD<\/a><\/td><td>Return a value evaluated at the row that is <tt class=\"REPLACEABLE c4\">offset <\/tt>rows after the current row within the partition.<\/td><\/tr><tr><td><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-ntile-function\/\">NTILE<\/a><\/td><td>Divide rows in a partition as equally as possible and assign each row an integer starting from 1 to the argument value.<\/td><\/tr><tr><td><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-nth_value-function\/\">NTH_VALUE<\/a><\/td><td>Return a value evaluated against the nth row in an ordered partition.<\/td><\/tr><tr><td><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-percent_rank-function\/\">PERCENT_RANK<\/a><\/td><td>Return the relative rank of the current row (rank-1) \/ (total rows &#8211; 1)<\/td><\/tr><tr><td><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/\">RANK<\/a><\/td><td>Rank the current row within its partition with gaps.<\/td><\/tr><tr><td><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-row_number\/\">ROW_NUMBER<\/a><\/td><td>Number the current row within its partition starting from 1.<\/td><\/tr><\/tbody><\/table><\/figure>\n\n\n\n<h2>The <code>ROW_NUMBER()<\/code>, <code>RANK()<\/code>, and <code>DENSE_RANK()<\/code> functions<\/h2>\n\n\n\n<p>The <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-row_number\/\">ROW_NUMBER()<\/a><\/code>, <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/\">RANK()<\/a><\/code>, and <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-dense_rank-function\/\">DENSE_RANK()<\/a><\/code> functions assign an integer to each row based on its order in its result set.<\/p>\n\n\n\n<p>The <code>ROW_NUMBER()<\/code> function assigns a sequential number to each row in each partition. See the following query:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-11\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span>\n\tproduct_name,\n\tgroup_name,\n\tprice,\n\tROW_NUMBER () <span class=\"hljs-keyword\">OVER<\/span> (\n\t\t<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> group_name\n\t\t<span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span>\n\t\t\tprice\n\t)\n<span class=\"hljs-keyword\">FROM<\/span>\n\tproducts\n<span class=\"hljs-keyword\">INNER<\/span> <span class=\"hljs-keyword\">JOIN<\/span> product_groups <span class=\"hljs-keyword\">USING<\/span> (<span class=\"hljs-keyword\">group_id<\/span>);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-11\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"376\" height=\"214\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/PostgreSQL-Window-Function-ROW_NUMBER-function.png\" alt=\"PostgreSQL Window Function - ROW_NUMBER function\" class=\"wp-image-3658\"\/><\/figure>\n\n\n\n<p>The <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-rank-function\/\">RANK()<\/a><\/code> function assigns ranking within an ordered partition. If rows have the same values, the&nbsp; <code>RANK()<\/code> function assigns the same rank, with the next ranking(s) skipped.<\/p>\n\n\n\n<p>See the following query:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-12\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span>\n\tproduct_name,\n\tgroup_name,\n  price,\n\t<span class=\"hljs-keyword\">RANK<\/span> () <span class=\"hljs-keyword\">OVER<\/span> (\n\t\t<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> group_name\n\t\t<span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span>\n\t\t\tprice\n\t)\n<span class=\"hljs-keyword\">FROM<\/span>\n\tproducts\n<span class=\"hljs-keyword\">INNER<\/span> <span class=\"hljs-keyword\">JOIN<\/span> product_groups <span class=\"hljs-keyword\">USING<\/span> (<span class=\"hljs-keyword\">group_id<\/span>);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-12\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"344\" height=\"217\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/PostgreSQL-Window-Function-RANK-function.png\" alt=\"PostgreSQL Window Function - RANK function\" class=\"wp-image-3657\"\/><\/figure>\n\n\n\n<p>In the laptop product group, both <code>Dell Vostro<\/code> and <code>Sony VAIO<\/code> products have the same price, therefore, they receive the same rank 1. The next row in the group is <code>HP Elite<\/code>&nbsp;that receives the rank 3 because the rank 2 is skipped.<\/p>\n\n\n\n<p>Similar to the <code>RANK()<\/code> function, the <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-dense_rank-function\/\">DENSE_RANK()<\/a><\/code> function assigns a rank to each row within an ordered partition, but the ranks have no gap. In other words, the same ranks are assigned to multiple rows and no ranks are skipped.<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-13\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span>\n\tproduct_name,\n\tgroup_name,\n\tprice,\n\t<span class=\"hljs-keyword\">DENSE_RANK<\/span> () <span class=\"hljs-keyword\">OVER<\/span> (\n\t\t<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> group_name\n\t\t<span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span>\n\t\t\tprice\n\t)\n<span class=\"hljs-keyword\">FROM<\/span>\n\tproducts\n<span class=\"hljs-keyword\">INNER<\/span> <span class=\"hljs-keyword\">JOIN<\/span> product_groups <span class=\"hljs-keyword\">USING<\/span> (<span class=\"hljs-keyword\">group_id<\/span>);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-13\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"374\" height=\"215\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/PostgreSQL-Window-Function-DENSE_RANK-function.png\" alt=\"PostgreSQL Window Function - DENSE_RANK function\" class=\"wp-image-3652\"\/><\/figure>\n\n\n\n<p>Within the laptop product group, rank 1 is assigned twice to <code>Dell Vostro<\/code> and <code>Sony VAIO<\/code>. The next rank is 2 assigned to <code>HP Elite<\/code>.<\/p>\n\n\n\n<h2>The <code>FIRST_VALUE<\/code> and <code>LAST_VALUE<\/code> functions<\/h2>\n\n\n\n<p>The <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-first_value-function\/\">FIRST_VALUE()<\/a><\/code> function returns a value evaluated against the first row within its partition, whereas the <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-last_value-function\/\">LAST_VALUE()<\/a><\/code> function returns a value evaluated against the last row in its partition.<\/p>\n\n\n\n<p>The following statement uses the <code>FIRST_VALUE()<\/code> to return the lowest price for every product group.<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-14\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span>\n\tproduct_name,\n\tgroup_name,\n\tprice,\n\t<span class=\"hljs-keyword\">FIRST_VALUE<\/span> (price) <span class=\"hljs-keyword\">OVER<\/span> (\n\t\t<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> group_name\n\t\t<span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span>\n\t\t\tprice\n\t) <span class=\"hljs-keyword\">AS<\/span> lowest_price_per_group\n<span class=\"hljs-keyword\">FROM<\/span>\n\tproducts\n<span class=\"hljs-keyword\">INNER<\/span> <span class=\"hljs-keyword\">JOIN<\/span> product_groups <span class=\"hljs-keyword\">USING<\/span> (<span class=\"hljs-keyword\">group_id<\/span>);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-14\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"428\" height=\"217\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/PostgreSQL-Window-Function-FIRST_VALUE-function.png\" alt=\"PostgreSQL Window Function - FIRST_VALUE function\" class=\"wp-image-3653\"\/><\/figure>\n\n\n\n<p>The following statement uses the <code>LAST_VALUE()<\/code> function to return the highest price for every product group.<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-15\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span>\n\tproduct_name,\n\tgroup_name,\n\tprice,\n\t<span class=\"hljs-keyword\">LAST_VALUE<\/span> (price) <span class=\"hljs-keyword\">OVER<\/span> (\n\t\t<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> group_name\n\t\t<span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span>\n\t\t\tprice <span class=\"hljs-keyword\">RANGE<\/span> <span class=\"hljs-keyword\">BETWEEN<\/span> <span class=\"hljs-keyword\">UNBOUNDED<\/span> <span class=\"hljs-keyword\">PRECEDING<\/span>\n\t\t<span class=\"hljs-keyword\">AND<\/span> <span class=\"hljs-keyword\">UNBOUNDED<\/span> <span class=\"hljs-keyword\">FOLLOWING<\/span>\n\t) <span class=\"hljs-keyword\">AS<\/span> highest_price_per_group\n<span class=\"hljs-keyword\">FROM<\/span>\n\tproducts\n<span class=\"hljs-keyword\">INNER<\/span> <span class=\"hljs-keyword\">JOIN<\/span> product_groups <span class=\"hljs-keyword\">USING<\/span> (<span class=\"hljs-keyword\">group_id<\/span>);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-15\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"441\" height=\"212\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/PostgreSQL-Window-Function-LAST_VALUE-function.png\" alt=\"PostgreSQL Window Function - LAST_VALUE function\" class=\"wp-image-3655\"\/><\/figure>\n\n\n\n<p>Notice that we added the frame clause <code>RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING<\/code> because by default the frame clause is <code>RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW<\/code>.<\/p>\n\n\n\n<h2>The <code>LAG<\/code> and <code>LEAD<\/code> functions<\/h2>\n\n\n\n<p>The <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-lag-function\/\">LAG()<\/a><\/code> function has the&nbsp;ability to access data from the previous row, while the <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-lead-function\/\">LEAD()<\/a><\/code> function can access data from the next row.<\/p>\n\n\n\n<p>Both <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-lag-function\/\">LAG()<\/a><\/code> and <code><a href=\"https:\/\/www.postgresqltutorial.com\/postgresql-lead-function\/\">LEAD()<\/a><\/code> functions have the same syntax as follows:<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-16\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\">LAG  (expression [,offset] [,default]) over_clause;\nLEAD (expression [,offset] [,default]) over_clause;<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-16\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<p>In this syntax:<\/p>\n\n\n\n<ul><li>&nbsp;<code>expression<\/code> &#8211; a column or expression to compute the returned&nbsp;value.<\/li><li>&nbsp;<code>offset<\/code> &#8211; the number of rows preceding ( <code>LAG<\/code>)\/ following ( <code>LEAD<\/code>) the current row. It defaults to&nbsp;1.<\/li><li>&nbsp;<code>default<\/code> &#8211; the default returned value if the <code>offset<\/code> goes beyond the scope of the window. The <code>default<\/code> is <code>NULL<\/code> if you skip it.<\/li><\/ul>\n\n\n\n<p>The following statement uses the <code>LAG()<\/code> function to return the prices from the previous row and calculates the difference between the price of the current row&nbsp;and the previous row.<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-17\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span>\n\tproduct_name,\n\tgroup_name,\n\tprice,\n\tLAG (price, <span class=\"hljs-number\">1<\/span>) <span class=\"hljs-keyword\">OVER<\/span> (\n\t\t<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> group_name\n\t\t<span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span>\n\t\t\tprice\n\t) <span class=\"hljs-keyword\">AS<\/span> prev_price,\n\tprice - LAG (price, <span class=\"hljs-number\">1<\/span>) <span class=\"hljs-keyword\">OVER<\/span> (\n\t\t<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> group_name\n\t\t<span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span>\n\t\t\tprice\n\t) <span class=\"hljs-keyword\">AS<\/span> cur_prev_diff\n<span class=\"hljs-keyword\">FROM<\/span>\n\tproducts\n<span class=\"hljs-keyword\">INNER<\/span> <span class=\"hljs-keyword\">JOIN<\/span> product_groups <span class=\"hljs-keyword\">USING<\/span> (<span class=\"hljs-keyword\">group_id<\/span>);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-17\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"469\" height=\"215\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/PostgreSQL-Window-Function-LAG-function.png\" alt=\"PostgreSQL Window Function - LAG function\" class=\"wp-image-3654\"\/><\/figure>\n\n\n\n<p>The following statement uses the <code>LEAD()<\/code> function to return the prices from the next row and calculates the difference between the price of the current row&nbsp;and the next row.<\/p>\n\n\n<pre class=\"wp-block-code\" aria-describedby=\"shcb-language-18\" data-shcb-language-name=\"SQL (Structured Query Language)\" data-shcb-language-slug=\"sql\"><div><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT<\/span>\n\tproduct_name,\n\tgroup_name,\n\tprice,\n\t<span class=\"hljs-keyword\">LEAD<\/span> (price, <span class=\"hljs-number\">1<\/span>) <span class=\"hljs-keyword\">OVER<\/span> (\n\t\t<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> group_name\n\t\t<span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span>\n\t\t\tprice\n\t) <span class=\"hljs-keyword\">AS<\/span> next_price,\n\tprice - <span class=\"hljs-keyword\">LEAD<\/span> (price, <span class=\"hljs-number\">1<\/span>) <span class=\"hljs-keyword\">OVER<\/span> (\n\t\t<span class=\"hljs-keyword\">PARTITION<\/span> <span class=\"hljs-keyword\">BY<\/span> group_name\n\t\t<span class=\"hljs-keyword\">ORDER<\/span> <span class=\"hljs-keyword\">BY<\/span>\n\t\t\tprice\n\t) <span class=\"hljs-keyword\">AS<\/span> cur_next_diff\n<span class=\"hljs-keyword\">FROM<\/span>\n\tproducts\n<span class=\"hljs-keyword\">INNER<\/span> <span class=\"hljs-keyword\">JOIN<\/span> product_groups <span class=\"hljs-keyword\">USING<\/span> (<span class=\"hljs-keyword\">group_id<\/span>);<\/code><\/div><small class=\"shcb-language\" id=\"shcb-language-18\"><span class=\"shcb-language__label\">Code language:<\/span> <span class=\"shcb-language__name\">SQL (Structured Query Language)<\/span> <span class=\"shcb-language__paren\">(<\/span><span class=\"shcb-language__slug\">sql<\/span><span class=\"shcb-language__paren\">)<\/span><\/small><\/pre>\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" width=\"465\" height=\"217\" src=\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2018\/12\/PostgreSQL-Window-Function-LEAD-function.png\" alt=\"PostgreSQL Window Function - LEAD function\" class=\"wp-image-3656\"\/><\/figure>\n\n\n\n<p>In this tutorial, we have introduced you to the PostgreSQL window functions and shown you some examples of using them to query data.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>In this tutorial, you will learn how to use the PostgreSQL window functions to perform the calculation across the set of rows related to the current row.<\/p>\n","protected":false},"author":1,"featured_media":4482,"parent":0,"menu_order":12,"comment_status":"closed","ping_status":"closed","template":"","meta":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v19.0 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>PostgreSQL Window Functions: The Ultimate Guide<\/title>\n<meta name=\"description\" content=\"In this tutorial, you will learn how to use the PostgreSQL window functions to perform the calculation across the set of rows related to the current row.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/\" \/>\n<meta name=\"twitter:label1\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data1\" content=\"10 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/#website\",\"url\":\"https:\/\/www.postgresqltutorial.com\/\",\"name\":\"PostgreSQL Tutorial\",\"description\":\"Comprehensive Postgresql Tutorial\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/www.postgresqltutorial.com\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/#primaryimage\",\"url\":\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2020\/03\/window-functions.png\",\"contentUrl\":\"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2020\/03\/window-functions.png\",\"width\":150,\"height\":150},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/#webpage\",\"url\":\"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/\",\"name\":\"PostgreSQL Window Functions: The Ultimate Guide\",\"isPartOf\":{\"@id\":\"https:\/\/www.postgresqltutorial.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/#primaryimage\"},\"datePublished\":\"2016-06-20T05:02:39+00:00\",\"dateModified\":\"2021-04-27T01:56:11+00:00\",\"description\":\"In this tutorial, you will learn how to use the PostgreSQL window functions to perform the calculation across the set of rows related to the current row.\",\"breadcrumb\":{\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https:\/\/www.postgresqltutorial.com\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"PostgreSQL Window Functions\"}]}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"PostgreSQL Window Functions: The Ultimate Guide","description":"In this tutorial, you will learn how to use the PostgreSQL window functions to perform the calculation across the set of rows related to the current row.","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/","twitter_misc":{"Est. reading time":"10 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"https:\/\/www.postgresqltutorial.com\/#website","url":"https:\/\/www.postgresqltutorial.com\/","name":"PostgreSQL Tutorial","description":"Comprehensive Postgresql Tutorial","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/www.postgresqltutorial.com\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","inLanguage":"en-US","@id":"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/#primaryimage","url":"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2020\/03\/window-functions.png","contentUrl":"https:\/\/www.postgresqltutorial.com\/wp-content\/uploads\/2020\/03\/window-functions.png","width":150,"height":150},{"@type":"WebPage","@id":"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/#webpage","url":"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/","name":"PostgreSQL Window Functions: The Ultimate Guide","isPartOf":{"@id":"https:\/\/www.postgresqltutorial.com\/#website"},"primaryImageOfPage":{"@id":"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/#primaryimage"},"datePublished":"2016-06-20T05:02:39+00:00","dateModified":"2021-04-27T01:56:11+00:00","description":"In this tutorial, you will learn how to use the PostgreSQL window functions to perform the calculation across the set of rows related to the current row.","breadcrumb":{"@id":"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/www.postgresqltutorial.com\/postgresql-window-function\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/www.postgresqltutorial.com\/"},{"@type":"ListItem","position":2,"name":"PostgreSQL Window Functions"}]}]}},"_links":{"self":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/1737"}],"collection":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/comments?post=1737"}],"version-history":[{"count":2,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/1737\/revisions"}],"predecessor-version":[{"id":6036,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/pages\/1737\/revisions\/6036"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/media\/4482"}],"wp:attachment":[{"href":"https:\/\/www.postgresqltutorial.com\/wp-json\/wp\/v2\/media?parent=1737"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}